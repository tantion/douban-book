define("js/duokan",["jquery","mustache"],function(require,a,b){"use strict";function c(a){var b=new f.Deferred,c=[],d="http://www.duokan.com/search/#keyword#/1";return d=d.replace("#keyword#",encodeURIComponent(a)),h.hasOwnProperty(d)?(c=h[d],c&&c.length?b.resolve(c):b.reject()):f.ajax({url:d,type:"GET",timeout:i,xhrFields:{withCredentials:!0}}).done(function(c){c=c.replace(/src=/gi,"data-src=");var e=f(f.parseHTML(c)),g=e.find(".j-list .j-bookitm"),i=[];i=f.map(g,function(b){var c=f(b),d=c.data("id"),e=c.find(".book .cover img").data("src"),g=c.find(".info .title"),h=f.trim(g.text()),i=g.attr("href");return h.indexOf(a)>-1?{href:"http://www.duokan.com"+i,title:h,cover:e,id:d}:void 0}),h[d]=i,i.length?b.resolve(i):b.reject()}).fail(function(){b.reject()}),b.promise()}function d(a){var b=g.render(j,{items:a}),c=f(b);return c.on("mouseenter","a",function(){f(this).tipsy({gravity:"w",offset:3}).tipsy("show")}),c}function e(a){var b=a.title,e=new f.Deferred;return b?(e.notify("正在加载搜索结果，请耐心等待..."),c(b).done(function(a){e.resolve(d(a),a.length,a)}).fail(function(){e.reject()})):e.reject(),e.promise()}var f=require("jquery"),g=require("mustache"),h={},i=3e4,j='{{#items}}<dl class="book-improve-bt-dl"><dt class="book-improve-bt-title"><a title="在线阅读" target="_blank" href="http://www.duokan.com/reader/www/app.html?id={{id}}">{{&title}}</a></dt>{{#files}}<dd class="book-improve-bt-desc">{{&title}}</dd>{{/files}}</dl>{{/items}}';b.exports={name:"多看阅读",search:e}});